<!-- <p>report works!</p> -->

<div class="row">

    <div class="col-md-4">
        <h3 style="margin-top: 14px;margin-bottom: 0px; font-weight: 700;font-size: 28px;">{{this.reportheader}}</h3>
    </div>

    <div class="col-md-8" >


        <!-- <div  *ngIf="reportname=='Report_Resume'" class="input-group my-group pull-right"style="height:32px; width:815px !important;margin-right:12px;margin-top:8px;margin-bottom: 6px;"> -->
        <div  *ngIf="reportname=='Report_Resume'" class="input-group my-group pull-right"style="height:32px; width:855px !important;margin-right:12px;margin-top:8px;margin-bottom: 6px;">

            <!-- [(ngModel)]="selectedItem" used for restoring the cmb value after coming from prosearch form -->
            <!-- Not using (change)="setfindid($event)" after  [(ngModel)] is used-->
            <!-- should use float: left when other cmb is prsent; -->
            <!-- // to prevent dropdown on mouse right click onMouseDown($event) is used-->

            <ng-select *ngIf="reportname=='Report_Resume'" [(ngModel)]="selectedEmpID" (change)="getSelectedEmpID($event)" #empidSelect
              blockRightClickDropdown
            [items]="cmbEmp" 
                bindLabel="EmployeeID" 
                bindValue="EmpID"
                class="ngselect_report_empresume" 
                placeholder="select employee" 
                style="height: 34px; width: 250px;float: left;"
                [searchable]="true" 
                [clearable]="true" 
                [dropdownPosition]="'bottom'" 
                (click)="toggleDropdown(empidSelect)"
                (mousedown)="onMouseDown($event)"
                (focus)="onFocus()" required>
            </ng-select>

            <ng-select *ngIf="reportname=='Report_Resume'" [(ngModel)]="selectedEmpExpItem" (change)="getSelectedEmpExpItem($event)" #empexpitemSelect
                [items]="CmbEmpExpItem" 
                bindLabel="Str1" 
                bindValue="ListID"
                class="ngselect_report_empresume" 
                placeholder="select experience summary type" 
                style="height: 34px; width: 280px;float: left;"
                [searchable]="true" 
                [clearable]="true" 
                [dropdownPosition]="'bottom'" 
                (click)="toggleDropdown(empexpitemSelect)"
                (mousedown)="onMouseDown($event)"
                (focus)="onFocus()" required>
            </ng-select>





            <span class="input-group-btn">
                <!-- <a routerLink="/Empdetail/{{findid}}" (click)="findbyemployeeid()"  class="btn btn-default" style="height:36px;padding-top:8px;border-color: #aaa;">GO</a> -->
                
                <button *ngIf="selectedProjectID==null" title="Select projects from search form" id="selectProjects"  (click)="openProjectSearch()" class="btn btn-default " style="height:36px;min-width:163px !important;padding-top:8px;border-color: #aaa;"><span aria-hidden="true"
                 class="glyphicon glyphicon-open" style="color:#007714;margin-right: 3px;"></span> Select Projects</button>
                
                <button *ngIf="selectedProjectID!=null" id="projectsSelected" class="btn btn-default" style="height:36px;min-width:163px !important;padding-top:8px;border-color: #aaa;"><span aria-hidden="true"
                 class="glyphicon glyphicon-ok" style="color:#007714;margin-right: 3px;"></span> Projects Selected</button>
               
                 <button (click)="clearAll()" title="Reset report parameters" class="btn btn-default" style="height:36px;min-width:30px !important;padding:10px;border-color: #aaa;"><span aria-hidden="true"
                 class="glyphicon glyphicon-refresh" style="color:#007714;margin-right: 3px;"></span></button>

                <a (click)="generatereport()" title="Generate report" class="btn btn-primary" id="generatereportbtn"
                    style="height:36px;padding-top:8px;border-color: #aaa;margin-left: 10px;">Create Report</a>
                <!-- <a (click)="backtoreport()" class="btn btn-default"
                                style="height:36px;padding-top:8px;border-color: #aaa;color:#3c8dbc; margin-left: 10px;" ><i class="fa fa-arrow-left" aria-hidden="true"></i> back to reports</a> -->
            </span>

        </div>
        <!-- end div for emp -->



        <div *ngIf="reportname=='Report_PDS'" class="input-group my-group pull-right"style="height:32px; width:150px !important;margin-right:12px;margin-top:8px;margin-bottom: 6px;">

            <ng-select  *ngIf="reportname=='Report_PDS'" (change)="getSelectedProjectID($event)" #projectidSelect
                [items]="cmbProject" 
                bindLabel="ProjectName" 
                bindValue="ProjectID" 
                class="ngselect_prodetail_project"  
                placeholder="search project"
                style="height: 34px; width: 500px;"
                [searchable]="true"
                [clearable]="true"
                [dropdownPosition]="'bottom'" 
                (click)="toggleDropdown(projectidSelect)"
                (mousedown)="onMouseDown_ProjectID($event)"
                (focus)="onFocus()" required>
            </ng-select>

            <span class="input-group-btn">
                <!-- <a routerLink="/Empdetail/{{findid}}" (click)="findbyemployeeid()"  class="btn btn-default" style="height:36px;padding-top:8px;border-color: #aaa;">GO</a> -->
                <a (click)="generatereport()" class="btn btn-default" id="generatereportbtn"
                    style="height:36px;padding-top:8px;border-color: #aaa;">Generate Report</a>
            </span>


        </div>
        <!-- end div for pro -->




    </div>

</div>
<!-- end row -->



<!-- <button (click)="test()">test</button> -->
<!-- Turned of bold rpt for using PowerBi report -->
<!-- <bold-reportviewer id="reportViewer_Control" [reportServiceUrl]="reportServiceUrl" [reportServerUrl]="reportServerUrl"
    [reportPath]="reportPath" [parameters]="reportParameters"
    [serviceAuthorizationToken]="serverServiceAuthorizationToken" style="width: 100%;height: 670px">
</bold-reportviewer> -->

<!-- 2025 PowerBi Report -->
<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=c3e8d973-47ab-4042-b913-60e78d997a10&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&clientSideAuth=0" frameborder="0" allowFullScreen="true"></iframe> -->
<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="600" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=c3e8d973-47ab-4042-b913-60e78d997a10&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&clientSideAuth=false" frameborder="0" allowFullScreen="true"></iframe> -->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=c3e8d973-47ab-4042-b913-60e78d997a10&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->



<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="600" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=c3e8d973-47ab-4042-b913-60e78d997a10&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->
<!-- report name in powerbi service: powerbi-resume-06 -->

<!-- working with no param -->
<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="600" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=999821b0-cc66-459e-8338-01c7c736ceb9&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->


<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=f81f0208-9b6f-4b0e-924f-f7a168434067&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->
<!-- report name in powerbi service: powerbi-pds-05 -->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=0923a757-d630-41c5-94a4-fa78777fa0ad&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->

<!-- Parameter test report name in powerbi service: powerbi-pds-06, Note in report builder param visibility turned off even with err but no erreo in angular app report-->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=751f59f1-689d-48a5-94c8-233c392c2af5&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&rs:embed=true&rp:Parameter1=1" frameborder="0" allowFullScreen="true"></iframe> -->



<!-- url with dynamic parameter must be sanatized in ts file to avoid unsafe url err using [src]="safeUrl"-->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" [src]="safeUrl" allowFullScreen="true"></iframe> -->
<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" [src]="safeUrl" allowFullScreen="true"></iframe> -->
<!-- <iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" [src]="safeUrl2" allowFullScreen="true"></iframe> -->



<!-- working with NO CUSTOMIZED PARAMETERS -->
<!--testparam <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=751f59f1-689d-48a5-94c8-233c392c2af5&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&rs:embed=true&rp:Parameter1=1" frameborder="0" allowFullScreen="true"></iframe> -->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=751f59f1-689d-48a5-94c8-233c392c2af5&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe>
<iframe *ngIf="powerbirpt== 'resume'" role="presentation" width="800" height="600" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=999821b0-cc66-459e-8338-01c7c736ceb9&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi" frameborder="0" allowFullScreen="true"></iframe> -->




<!-- with CUSTOMIZED PARAMETERS common for all dynamic reports in one line-->
<!-- <iframe role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" [src]="safeUrl" allowFullScreen="true"></iframe> -->
<div style="border: 1px solid #ababab; width: 1240px;height: 660px;"><div *ngIf="!iframevisible" style="color:#a3a3a3;font-size: larger;font-weight: bold;text-align: center !important; margin-top: 300px;">REPORT VIEWER</div>
    <iframe *ngIf="iframevisible" role="presentation" width="800" height="650"
        style="width: 100%;height: 100%;min-height: 650px; border: 1px solid #f1f1f1" 
        [src]="safeUrl" allowFullScreen="true">
    </iframe>
</div>


<!-- test parameter -->
<!-- <a href="https://app.powerbi.com/rdlEmbed?reportId=b3c61321-2bd6-47f7-b80b-bb7f91148473&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&rp:Parameter1={{parameter1}}">test</a>-->
<!-- <iframe *ngIf="powerbirpt== 'pds'" role="presentation" width="800" height="650" style="width: 99%;height: 100%;min-height: 650px; border: 1px solid rgb(183, 183, 183);" src="https://app.powerbi.com/rdlEmbed?reportId=b3c61321-2bd6-47f7-b80b-bb7f91148473&autoAuth=true&ctid=d16fe3ee-a81a-45be-8c93-d1db70f836eb&experience=power-bi&rs:embed=true&rp:Parameter1={{parameter1}}" frameborder="0" allowFullScreen="true"></iframe>  -->